{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-pencil-square"></i> Edit Location</h2>
        <a href="/main" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Back to Map
        </a>
    </div>

    {% if obj.errors | length > 0 %}
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="bi bi-exclamation-triangle-fill"></i> <strong>Please fix the following errors:</strong>
        <ul class="mb-0 mt-2">
            {% for error in obj.errors %}
                <li>{{ error }}</li>
            {% endfor %}
        </ul>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}

    <div class="card">
        <div class="card-body">
            <form action="manage?action=update&pkval={{ obj.data[0][obj.pk] }}" method="POST">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="name" class="form-label">Area Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="name" name="name" value="{{ obj.data[0].name }}" required>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="latitude" class="form-label">Latitude <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="latitude" name="latitude" value="{{ obj.data[0].latitude }}" required>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="longitude" class="form-label">Longitude <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="longitude" name="longitude" value="{{ obj.data[0].longitude }}" required>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="description" class="form-label">Description</label>
                    <textarea class="form-control" id="description" name="description" rows="3">{{ obj.data[0].description }}</textarea>
                    <div class="form-text">General description of the area, access information, parking, etc.</div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-4">
                        <label class="form-label">Submitted By</label>
                        <p class="form-control-plaintext">User ID {{ obj.data[0].submitted_by }}</p>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Created Date</label>
                        <p class="form-control-plaintext">{{ obj.data[0].submission_timestamp }}</p>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Verified</label>
                        <p class="form-control-plaintext">
                            {% if obj.data[0].verified %}
                                <span class="badge bg-success"><i class="bi bi-check-circle"></i> Yes</span>
                            {% else %}
                                <span class="badge bg-warning"><i class="bi bi-hourglass"></i> No</span>
                            {% endif %}
                        </p>
                    </div>
                </div>

                <div class="d-flex justify-content-between">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="bi bi-save"></i> Update Location
                    </button>
                    <a href="/locations/manage?pkval={{ obj.data[0][obj.pk] }}&action=delete"
                       class="btn btn-danger"
                       onclick="return confirm('Are you sure you want to delete this location? This will also delete all associated jump points. This action cannot be undone.')">
                        <i class="bi bi-trash"></i> Delete Location
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
